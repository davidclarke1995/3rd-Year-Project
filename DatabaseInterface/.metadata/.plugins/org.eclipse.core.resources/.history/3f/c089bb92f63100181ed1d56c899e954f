
package ie.gmit.sw;

import java.io.Console;
import java.sql.*;
import java.util.*;

public class DbAccess {
	// https://www.javatpoint.com/example-to-connect-to-the-mysql-database

	/**
	 * @param args
	 * @throws SQLException
	 */
	@SuppressWarnings({ "unlikely-arg-type", "null" })
	public static void main(String args[]) throws SQLException {

		Scanner console = new Scanner(System.in);
		int option = 0;
		String name = "";
		String userName = "";
		String password = "";

		boolean loginSuccess = false;

		System.out.println(
				"Select 1 to view contents\nSelect 2 to add to DB\nSelect 3 to delete\nSelect 4 to Sign in-1 to exit");
		option = console.nextInt();

		while (option != -1) {
			if (option == 1) {

				try {
					Class.forName("com.mysql.jdbc.Driver");
					Connection conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/users", "root", "");
					// System.out.println("1111");

					Statement stmt = conn.createStatement();
					ResultSet rs = stmt.executeQuery("SELECT * FROM userDetails");
					// System.out.println("1111");
					final ArrayList<User> users = new ArrayList<User>();

					while (rs.next()) {
						User user = new User();
						user.setName(rs.getString(1));
						user.setUserName(rs.getString(2));
						user.setPassword(rs.getString(3));
						users.add(user);

						System.out.println("" + user.getName() + " " + user.getUserName() + " " + user.getPassword());
						// System.out.println("1111");

						// conn.close();
					} // end while
				} catch (Exception e) {
					System.out.println(e);
				} // end catch
			} // end option 1 view
			else if (option == 2) {
				try {

					User user = new User();

					System.out.println("Please Enter a name: ");
					name = console.next();
					user.setName(name);
					System.out.println("Please Enter Username: ");
					userName = console.next();
					user.setUserName(userName);
					System.out.println("Please enter a password: ");
					password = console.next();
					user.setPassword(password);
					System.out.println(name + " " + userName + " " + password);

					Class.forName("com.mysql.jdbc.Driver");
					Connection conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/user", "root", "");
					PreparedStatement stmt = null;

					String sql = "INSERT INTO userDetails VALUES (? , ? , ?);";

					stmt = conn.prepareStatement(sql);
					stmt.setString(1, user.getName());
					stmt.setString(2, user.getUserName());
					stmt.setString(3, user.getPassword());

					stmt.execute();

				} catch (ClassNotFoundException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}

			}

		} // end while

		console.close();

	}// end main

}// end class
